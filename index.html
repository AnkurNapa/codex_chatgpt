<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kasper Schulz Smart Brewery Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg: #f7f8fb;
      --card: #ffffff;
      --text: #1f2a44;
      --muted: #6b7280;
      --accent: #2f7cf6;
      --border: #e5e7eb;
      --shadow: 0 14px 40px rgba(31, 42, 68, 0.08);
      --radius: 16px;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      scroll-behavior: smooth;
    }

    a { color: inherit; text-decoration: none; }

    a:focus-visible, button:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    header {
      position: sticky;
      top: 0;
      z-index: 10;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border);
    }

    .nav-bar {
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 24px;
    }

    .brand {
      font-weight: 700;
      font-size: 1.1rem;
      letter-spacing: 0.4px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: linear-gradient(135deg, #2f7cf6, #0ea5e9);
      display: inline-block;
    }

    nav a {
      font-weight: 500;
      color: var(--muted);
      padding: 8px 10px;
      border-radius: 8px;
      transition: background 0.2s ease, color 0.2s ease;
    }

    nav a:hover { background: #eef2ff; color: var(--text); }

    main {
      max-width: 1200px;
      margin: 24px auto 80px;
      padding: 0 20px;
    }

    .page-header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 18px;
    }

    .title-block h1 {
      margin: 0;
      font-size: 1.9rem;
      letter-spacing: -0.5px;
    }

    .title-block p { margin: 4px 0 0; color: var(--muted); }

    .time-filters {
      display: inline-flex;
      align-items: center;
      background: #fff;
      padding: 6px;
      border-radius: 12px;
      border: 1px solid var(--border);
      box-shadow: 0 10px 30px rgba(31, 42, 68, 0.06);
    }

    .time-filters button {
      border: none;
      background: transparent;
      padding: 10px 14px;
      border-radius: 10px;
      font-weight: 600;
      color: var(--muted);
      cursor: pointer;
      transition: background 0.2s ease, color 0.2s ease, transform 0.1s ease;
    }

    .time-filters button:hover { color: var(--text); }

    .time-filters button.active {
      background: linear-gradient(135deg, #2f7cf6, #0ea5e9);
      color: #fff;
      box-shadow: var(--shadow);
    }

    @media (prefers-reduced-motion: reduce) {
      * { scroll-behavior: auto !important; transition: none !important; }
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 16px;
    }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 18px;
      border: 1px solid var(--border);
      box-shadow: 0 10px 28px rgba(31, 42, 68, 0.06);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .card h2 {
      margin: 0;
      font-size: 1.1rem;
    }

    .card p.desc { margin: 0; color: var(--muted); }

    .kpi-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .kpi {
      background: #f1f5f9;
      border-radius: 12px;
      padding: 10px 12px;
      flex: 1 1 120px;
      display: grid;
      gap: 4px;
    }

    .kpi span.label { color: var(--muted); font-size: 0.85rem; }
    .kpi span.value { font-weight: 700; color: var(--text); }

    .table-wrapper { overflow-x: auto; }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }

    thead { color: var(--muted); }
    th, td {
      padding: 8px 6px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    .chart-container {
      position: relative;
      height: 200px;
    }

    @media (max-width: 1024px) {
      .card-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }

    @media (max-width: 720px) {
      .nav-bar { flex-direction: column; align-items: flex-start; }
      nav { width: 100%; display: flex; flex-wrap: wrap; gap: 8px; }
      .page-header { align-items: flex-start; }
      .card-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <header>
    <div class="nav-bar">
      <div class="brand"><span class="dot"></span> Kasper Schulz Smart Brewery</div>
      <nav aria-label="Use case navigation">
        <a href="#predictive">Predictive Maintenance</a>
        <a href="#energy">Energy Optimization</a>
        <a href="#boil">Boil Efficiency</a>
        <a href="#fermentation">Fermentation Curve</a>
        <a href="#cip">CIP Optimization</a>
        <a href="#yield">Yield Loss</a>
      </nav>
    </div>
  </header>

  <main>
    <div class="page-header">
      <div class="title-block">
        <p class="desc" style="margin:0; color: var(--muted); font-weight:600;">Dashboard</p>
        <h1>Kasper Schulz Smart Brewery</h1>
        <p>Equipment analytics for predictive service, efficiency, and quality—built for brewhouse, cellar, and CIP teams.</p>
      </div>
      <div class="time-filters" aria-label="Time range filters">
        <button data-range="24h">Last 24h</button>
        <button data-range="7d" class="active">Last 7 days</button>
        <button data-range="30d">Last 30 days</button>
      </div>
    </div>

    <section class="card-grid">
      <article id="predictive" class="card">
        <h2>Predictive Maintenance</h2>
        <p class="desc">Track brewhouse pumps and rakes for early wear using vibration and temperature alerts.</p>
        <div class="kpi-row">
          <div class="kpi">
            <span class="label">Downtime reduced</span>
            <span class="value">-12%</span>
          </div>
          <div class="kpi">
            <span class="label">Alerts acknowledged</span>
            <span class="value">94%</span>
          </div>
          <div class="kpi">
            <span class="label">Avg. risk score</span>
            <span class="value">32</span>
          </div>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Equipment</th><th>Temp (°C)</th><th>Vibration (mm/s)</th><th>Status</th><th>Risk</th></tr>
            </thead>
            <tbody>
              <tr><td>Wort Pump A</td><td>62</td><td>4.2</td><td>Stable</td><td>28</td></tr>
              <tr><td>Hydro Mill</td><td>55</td><td>5.8</td><td>Watch</td><td>46</td></tr>
              <tr><td>Lauter Rake</td><td>48</td><td>3.1</td><td>Stable</td><td>22</td></tr>
              <tr><td>Whirlpool</td><td>60</td><td>6.2</td><td>Action</td><td>58</td></tr>
            </tbody>
          </table>
        </div>
        <div class="chart-container">
          <canvas id="predictiveChart" aria-label="Predictive maintenance risk chart"></canvas>
        </div>
      </article>

      <article id="energy" class="card">
        <h2>Energy Optimization</h2>
        <p class="desc">Compare steam, electric, and cooling loads per step to shrink kWh/hl across the brewhouse.</p>
        <div class="kpi-row">
          <div class="kpi">
            <span class="label">Energy per hl</span>
            <span class="value">9.4 kWh</span>
          </div>
          <div class="kpi">
            <span class="label">vs Target</span>
            <span class="value">-4%</span>
          </div>
          <div class="kpi">
            <span class="label">Cooling load</span>
            <span class="value">2.1 kWh</span>
          </div>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Process Step</th><th>kWh/hl</th><th>Target</th><th>Variance</th></tr>
            </thead>
            <tbody>
              <tr><td>Mash Heating</td><td>3.1</td><td>3.3</td><td>-0.2</td></tr>
              <tr><td>Boil</td><td>4.8</td><td>5.0</td><td>-0.2</td></tr>
              <tr><td>Whirlpool</td><td>1.0</td><td>0.9</td><td>+0.1</td></tr>
              <tr><td>Chill</td><td>0.5</td><td>0.6</td><td>-0.1</td></tr>
            </tbody>
          </table>
        </div>
        <div class="chart-container">
          <canvas id="energyChart" aria-label="Energy optimization chart"></canvas>
        </div>
      </article>

      <article id="boil" class="card">
        <h2>Boil Efficiency</h2>
        <p class="desc">Monitor boil-off rate and pre-boil gravity to keep flavor and utilization consistent.</p>
        <div class="kpi-row">
          <div class="kpi">
            <span class="label">Boil-off %</span>
            <span class="value">6.8%</span>
          </div>
          <div class="kpi">
            <span class="label">Energy / batch</span>
            <span class="value">68 kWh</span>
          </div>
          <div class="kpi">
            <span class="label">Grav. deviation</span>
            <span class="value">+0.2°P</span>
          </div>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Batch</th><th>Pre-boil °P</th><th>Boil-off %</th><th>Energy (kWh)</th></tr>
            </thead>
            <tbody>
              <tr><td>#2413</td><td>12.2</td><td>6.5</td><td>66</td></tr>
              <tr><td>#2414</td><td>12.5</td><td>7.1</td><td>70</td></tr>
              <tr><td>#2415</td><td>12.3</td><td>6.8</td><td>69</td></tr>
              <tr><td>#2416</td><td>12.4</td><td>6.7</td><td>67</td></tr>
            </tbody>
          </table>
        </div>
        <div class="chart-container">
          <canvas id="boilChart" aria-label="Boil efficiency chart"></canvas>
        </div>
      </article>

      <article id="fermentation" class="card">
        <h2>Fermentation Curve Intelligence</h2>
        <p class="desc">Follow tank cooling, gravity, and attenuation to flag slow ferments early.</p>
        <div class="kpi-row">
          <div class="kpi">
            <span class="label">Avg attenuation</span>
            <span class="value">78%</span>
          </div>
          <div class="kpi">
            <span class="label">Active tanks</span>
            <span class="value">12</span>
          </div>
          <div class="kpi">
            <span class="label">Days to FG</span>
            <span class="value">6.2</span>
          </div>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Tank</th><th>Phase</th><th>Temp (°C)</th><th>Attenuation</th><th>Days</th></tr>
            </thead>
            <tbody>
              <tr><td>F-12</td><td>High Krausen</td><td>18.5</td><td>62%</td><td>3</td></tr>
              <tr><td>F-14</td><td>Diacetyl Rest</td><td>20.0</td><td>74%</td><td>5</td></tr>
              <tr><td>F-08</td><td>Conditioning</td><td>1.8</td><td>82%</td><td>9</td></tr>
              <tr><td>F-10</td><td>Ramp Down</td><td>17.4</td><td>70%</td><td>4</td></tr>
            </tbody>
          </table>
        </div>
        <div class="chart-container">
          <canvas id="fermentationChart" aria-label="Fermentation curve chart"></canvas>
        </div>
      </article>

      <article id="cip" class="card">
        <h2>CIP Optimization</h2>
        <p class="desc">Balance cycle time, water, and chemical volume to keep lines clean with less resource use.</p>
        <div class="kpi-row">
          <div class="kpi">
            <span class="label">Cycle time</span>
            <span class="value">48 min</span>
          </div>
          <div class="kpi">
            <span class="label">Water saved</span>
            <span class="value">-12%</span>
          </div>
          <div class="kpi">
            <span class="label">Chemical vol.</span>
            <span class="value">18 L</span>
          </div>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>CIP Line</th><th>Cycle Time (min)</th><th>Water (L)</th><th>Chemical (L)</th></tr>
            </thead>
            <tbody>
              <tr><td>FV Loop</td><td>50</td><td>720</td><td>18</td></tr>
              <tr><td>Brite Loop</td><td>44</td><td>640</td><td>16</td></tr>
              <tr><td>Brewhouse</td><td>52</td><td>760</td><td>19</td></tr>
              <tr><td>Keg Line</td><td>40</td><td>580</td><td>14</td></tr>
            </tbody>
          </table>
        </div>
        <div class="chart-container">
          <canvas id="cipChart" aria-label="CIP optimization chart"></canvas>
        </div>
      </article>

      <article id="yield" class="card">
        <h2>Yield Loss Minimization</h2>
        <p class="desc">See where volume is lost between brewhouse, cellar, and packaging to tighten yields.</p>
        <div class="kpi-row">
          <div class="kpi">
            <span class="label">Total loss</span>
            <span class="value">3.2%</span>
          </div>
          <div class="kpi">
            <span class="label">Recovered beer</span>
            <span class="value">+4.1 hl</span>
          </div>
          <div class="kpi">
            <span class="label">Packaging loss</span>
            <span class="value">1.1%</span>
          </div>
        </div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr><th>Step</th><th>Volume In (hl)</th><th>Volume Out (hl)</th><th>Loss (hl)</th></tr>
            </thead>
            <tbody>
              <tr><td>Lauter Run-off</td><td>120</td><td>116.5</td><td>3.5</td></tr>
              <tr><td>Fermentation</td><td>116.5</td><td>114.0</td><td>2.5</td></tr>
              <tr><td>Transfer</td><td>114.0</td><td>112.8</td><td>1.2</td></tr>
              <tr><td>Packaging</td><td>112.8</td><td>111.6</td><td>1.2</td></tr>
            </tbody>
          </table>
        </div>
        <div class="chart-container">
          <canvas id="yieldChart" aria-label="Yield loss chart"></canvas>
        </div>
      </article>
    </section>
  </main>

  <script>
    // Dummy telemetry datasets; replace with live brewery data feeds.
    const chartData = {
      '24h': {
        predictive: { labels: ['02:00','06:00','10:00','14:00','18:00','22:00'], data: [22, 28, 35, 42, 39, 33] },
        energy: { labels: ['Mash','Boil','Whirlpool','Chill'], data: [3.4, 5.2, 1.1, 0.7] },
        boil: { labels: ['#2413','#2414','#2415','#2416'], data: [6.5, 7.2, 6.7, 6.9] },
        fermentation: { labels: ['Day 1','Day 2','Day 3','Day 4','Day 5'], data: [14.5, 10.8, 7.4, 5.1, 3.3] },
        cip: { labels: ['FV Loop','Brite Loop','Brewhouse','Keg Line'], data: [720, 640, 770, 600] },
        yield: {
          labels: ['Lauter','Fermentation','Transfer','Packaging'],
          dataA: [3.5, 2.5, 1.1, 0.8],
          dataB: [0.8, 0.6, 0.1, 0.4]
        }
      },
      '7d': {
        predictive: { labels: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'], data: [26, 30, 33, 40, 38, 32, 29] },
        energy: { labels: ['Mash','Boil','Whirlpool','Chill'], data: [3.1, 4.8, 1.0, 0.5] },
        boil: { labels: ['#2409','#2410','#2411','#2412','#2413','#2414'], data: [6.4, 6.9, 6.6, 6.7, 6.5, 7.1] },
        fermentation: { labels: ['Day 1','Day 2','Day 3','Day 4','Day 5','Day 6','Day 7'], data: [15.2, 12.4, 9.1, 6.7, 4.5, 3.1, 2.4] },
        cip: { labels: ['FV Loop','Brite Loop','Brewhouse','Keg Line'], data: [700, 630, 760, 590] },
        yield: {
          labels: ['Lauter','Fermentation','Transfer','Packaging'],
          dataA: [3.3, 2.2, 1.0, 0.9],
          dataB: [0.7, 0.5, 0.2, 0.3]
        }
      },
      '30d': {
        predictive: { labels: ['Week 1','Week 2','Week 3','Week 4'], data: [28, 35, 37, 31] },
        energy: { labels: ['Mash','Boil','Whirlpool','Chill'], data: [3.5, 5.5, 1.3, 0.9] },
        boil: { labels: ['#2390','#2395','#2400','#2405','#2410','#2415'], data: [6.8, 7.3, 6.9, 7.1, 6.6, 6.8] },
        fermentation: { labels: ['Day 1','Day 3','Day 5','Day 7','Day 9','Day 11'], data: [15.5, 11.2, 7.9, 5.8, 3.7, 2.9] },
        cip: { labels: ['FV Loop','Brite Loop','Brewhouse','Keg Line'], data: [710, 650, 780, 610] },
        yield: {
          labels: ['Lauter','Fermentation','Transfer','Packaging'],
          dataA: [3.6, 2.7, 1.2, 1.0],
          dataB: [0.9, 0.7, 0.2, 0.4]
        }
      }
    };

    const charts = {};

    function buildChartConfigs(rangeKey) {
      const range = chartData[rangeKey];
      return {
        predictive: {
          type: 'line',
          data: {
            labels: range.predictive.labels,
            datasets: [{
              label: 'Risk score',
              data: range.predictive.data,
              borderColor: '#2f7cf6',
              backgroundColor: 'rgba(47,124,246,0.12)',
              fill: true,
              tension: 0.35,
              pointRadius: 4
            }]
          },
          options: {
            responsive: true,
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: true, suggestedMax: 70 } }
          }
        },
        energy: {
          type: 'bar',
          data: {
            labels: range.energy.labels,
            datasets: [{
              label: 'kWh/hl',
              data: range.energy.data,
              backgroundColor: '#0ea5e9',
              borderRadius: 8
            }]
          },
          options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
        },
        boil: {
          type: 'line',
          data: {
            labels: range.boil.labels,
            datasets: [{
              label: 'Boil-off %',
              data: range.boil.data,
              borderColor: '#f97316',
              backgroundColor: 'rgba(249,115,22,0.15)',
              fill: true,
              tension: 0.35,
              pointRadius: 4
            }]
          },
          options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
        },
        fermentation: {
          type: 'line',
          data: {
            labels: range.fermentation.labels,
            datasets: [{
              label: 'Gravity (°P)',
              data: range.fermentation.data,
              borderColor: '#10b981',
              backgroundColor: 'rgba(16,185,129,0.15)',
              fill: true,
              tension: 0.35,
              pointRadius: 4
            }]
          },
          options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { reverse: true, beginAtZero: false } } }
        },
        cip: {
          type: 'bar',
          data: {
            labels: range.cip.labels,
            datasets: [{
              label: 'Water use (L)',
              data: range.cip.data,
              backgroundColor: '#6366f1',
              borderRadius: 8
            }]
          },
          options: { responsive: true, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
        },
        yield: {
          type: 'bar',
          data: {
            labels: range.yield.labels,
            datasets: [
              { label: 'Product loss', data: range.yield.dataA, backgroundColor: '#ef4444', borderRadius: 6, stack: 'loss' },
              { label: 'Trub/foam', data: range.yield.dataB, backgroundColor: '#fbbf24', borderRadius: 6, stack: 'loss' }
            ]
          },
          options: { responsive: true, plugins: { legend: { position: 'bottom' } }, scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true } } }
        }
      };
    }

    function syncChartConfig(chart, nextConfig) {
      chart.data.labels = nextConfig.data.labels;
      chart.data.datasets = nextConfig.data.datasets;
      chart.options = nextConfig.options;
      chart.update();
    }

    function updateCharts(timeRange) {
      const config = buildChartConfigs(timeRange);
      Object.keys(charts).forEach(key => syncChartConfig(charts[key], config[key]));
    }

    function initCharts() {
      const defaultRange = '7d';
      const configs = buildChartConfigs(defaultRange);
      charts.predictive = new Chart(document.getElementById('predictiveChart'), configs.predictive);
      charts.energy = new Chart(document.getElementById('energyChart'), configs.energy);
      charts.boil = new Chart(document.getElementById('boilChart'), configs.boil);
      charts.fermentation = new Chart(document.getElementById('fermentationChart'), configs.fermentation);
      charts.cip = new Chart(document.getElementById('cipChart'), configs.cip);
      charts.yield = new Chart(document.getElementById('yieldChart'), configs.yield);
    }

    document.addEventListener('DOMContentLoaded', () => {
      initCharts();

      const buttons = document.querySelectorAll('.time-filters button');
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          buttons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          updateCharts(btn.dataset.range);
        });
      });
    });
  </script>
</body>
</html>
